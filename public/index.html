<!-- public/index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Varcavia Search MVP</title>
  <style>
    body { font-family: sans-serif; margin: 20px; }
    .result { border:1px solid #ccc; padding:10px; margin:10px 0; }
    .title { font-weight: bold; }
    .meta  { color: #666; margin-bottom:5px; }
  </style>
</head>
<body>
  <h1>üîç Varcavia Universal Data Search</h1>
  <form id="f">
    <label>Testo: <input type="text" id="q"></label>
    <label>Fonte:
      <select id="source">
        <option value="all">Tutte</option>
        <option value="eur-oj">EUR-OJ</option>
        <option value="sec-edgar">SEC-EDGAR</option>
        <option value="it-gazzetta">Gazzetta</option>
        <option value="bankitalia">BankItalia</option>
        <option value="esma">ESMA</option>
        <option value="fincen">FinCEN</option>
        <option value="fca-uk">FCA-UK</option>
        <option value="bafin">BaFin</option>
        <option value="eba">EBA</option>
        <option value="worldbank">WorldBank</option>
        <option value="cnmv">CNMV</option>
      </select>
    </label>
    <button type="submit">Cerca</button>
  </form>
  <div id="results"></div>

  <script>
    document.getElementById('f').onsubmit = async e => {
      e.preventDefault();
      const q = document.getElementById('q').value;
      const source = document.getElementById('source').value;
      const res = await fetch(
        `/api/search?q=${encodeURIComponent(q)}&source=${encodeURIComponent(source)}`
      );
      const data = await res.json();
      const c = document.getElementById('results');
      if (!data.length) {
        c.innerHTML = '<p>Nessun risultato</p>';
        return;
      }
      c.innerHTML = data.map(d => `
        <div class="result">
          <div class="title">${d.title||d.id}</div>
          <div class="meta">Fonte: ${d.source} ‚Äî Hash: ${d.hash||'-'} ‚Äî Data: ${d.timestamp||'-'}</div>
          <div>${d.preview}</div>
        </div>
      `).join('');
    };
  </script>
</body>
</html>
